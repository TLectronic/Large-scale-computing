### 选题背景

DIFM（Dual Input-aware Factorization Machine）模型是用于点击率预估（CTR prediction）的先进模型之一。CTR预估是在线广告和推荐系统中的一个关键任务，旨在预测用户点击某个广告或推荐项目的概率。DIFM模型通过改进传统的因子分解机（FM）模型，整合多头自注意力、残差网络和DNN，提高了CTR预估的性能。

论文出处：https://www.ijcai.org/Proceedings/2020/0434.pdf

数据集来源：[Click-Through Rate Prediction | Kaggle](https://www.kaggle.com/competitions/avazu-ctr-prediction/data)

代码来源：[0322_deepctr_difm (kaggle.com)](https://www.kaggle.com/code/braincai/0322-deepctr-difm)

### DIFM模型特点

DIFM模型的核心思想是结合了因子分解机（FM）和神经网络（NN）的优点，基本思路就是：

- 使用因子分解机(FM)部分来学习特征之间的交互关系。
- 使用深度学习部分来学习特征的高阶组合和非线性关系。

以下是DIFM模型的主要原理：

1. **特征交互捕捉**：DIFM模型通过双重输入感知机制来捕捉特征之间的高阶交互信息。传统的FM模型仅考虑特征之间的二阶交互，而DIFM通过引入更多的高阶交互信息来增强模型的表现。
2. **双重输入感知机制**：DIFM模型由两个部分组成：主FM模块和辅助特征交互模块。主FM模块用于捕捉基础的特征交互信息，而辅助特征交互模块则通过一个多层感知器（MLP）进一步捕捉高阶的特征交互信息。
3. **组合输出**：DIFM模型将主FM模块和辅助特征交互模块的输出组合起来，生成最终的CTR预估值。这种组合方式使得模型能够充分利用特征交互信息，从而提高预估的准确性。

### DIFM模型结构

DIFM模型由以下组件组成：

（1）稀疏输入和嵌入层

（2）双因素Esti交配网络（Dual-FEN）层

（3）组合层

（4）重加权层

（5）预测层

![image-20240530120005275](C:\Users\11358\AppData\Roaming\Typora\typora-user-images\image-20240530120005275.png)

### DIFM模型工作过程

**（1）稀疏输入和嵌入层**：

假定现在有一个广告点击率预测的数据集，包含各种特征比如广告的分类、广告的位置、广告的发布者等，这些特征大多是类别型的，即离散取值。嵌入层就会把这些类别型特征映射到一个低维稠密空间，以便后续模型更方便学习它们之间的关系。

**（2）双因素Esti交配网络（Dual-FEN）层**：

双因素Esti交配网络（Dual-FEN）层是这个模型的主要创新点，这一层包含vector-wise部分和bit-wise部分。

vector-wise部分把嵌入层的输出经过一定处理后经过Multi-Head Self Attention（即多头自注意力模块）和Residual Network（即残差网络）得到两部分输出，然后两部分进行对位相加，并经过激活函数激活，得到vector-wise部分的输出，记作$O_{vec}$。这个部分学习到的是特征的高阶组合和非线性关系。比如某些类别在某些发布者下的特定组合可能会对点击率产生重要影响。

bit-wise部分将嵌入层的输出直接经过多层全连接网络处理，输出记作$O_{bit}$。这个部分学习到的是特征之间的交互关系。比如发布者和发布类别的相关性。

**（3）组合层**：

将$O_{vec}$和$O_{bit}$结合起来，二者输出维度不相同，需要通过矩阵分别转化为相同长度的向量然后二者进行对位相加。

**（4）重加权层**：

将组合层得到得结果和原本的特征放在一起，根据不同特征的重要性对特征进行加权，以提高模型的性能。

**（5）预测层**：

将重加权层处理过的特征输入到一个全连接神经网络中，最终输出广告被点击的概率。

